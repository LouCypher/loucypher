<?xml version="1.0" encoding="UTF-8"?>
<custombutton xmlns:cb="http://xsms.nm.ru/custombuttons"
              xmlns:html="http://www.w3.org/1999/xhtml">
  <html:head>
    <html:title></html:title>
    <html:link rel="shortcut icon" href=""/>
    <html:style type="text/css"><![CDATA[body{font-family:"Verdana";font-size:medium;margin:0;}#wrapper{position:fixed;top:1em;right:1em;text-align:center;}p{font-size:small;text-align:center;}#button{background-image:-moz-linear-gradient(center top,rgb(147,200,94)30%,rgb(85,168,2)55%);border:1px outset rgb(58,116,4);border-radius:1em;padding:0;text-shadow:0pt -1px 0pt rgb(58,116,4);margin-bottom:1em;}#button a{color:#ffffff;display:block;padding:1em;text-decoration:none;}#credits{position:fixed;bottom:1em;right:1em;font-size:small;}custombutton{background-color:AppWorkspace;margin:1em;}image,mode,accelkey{display:none;}name{font-weight:bold;font-size:x-large;}code:before{content:"/*CODE*/";}help:before{content:"/*Help*/";}initcode:before{content:"/*Initialization Code*/";}code,initcode,help{background-color:#f8f8f8;border:1px inset #dddddd;font:medium monospace;margin:1em 1em 2em 0;padding:1em;text-align:left;width:840px;white-space:pre-wrap;word-wrap:break-word;max-height:500px;overflow-y:auto;}code:hover,initcode:hover,help:hover{background-color:#fcfcfc;}code:active,initcode:active,help:active{background-color:#ffffff;}code,code:before,initcode,initcode:before,help,help:before{display:block;white-space:pre-wrap;}.clear{clear:both;}]]></html:style>
    <html:script type="text/javascript"><![CDATA[function cb(el){var serializer=new XMLSerializer();var xml=serializer.serializeToString(document);location.href="custombutton://"+escape(xml)}function tit(el,str){el.setAttribute("title",str)}function onLoad(){document.title=document.documentElement.getElementsByTagName("name")[0].textContent;document.getElementsByTagName("html:link")[0].href=document.documentElement.getElementsByTagName("image")[0].textContent}]]></html:script>
  </html:head>
  <html:body onload="onLoad();">
    <html:div id="wrapper">
      <html:div id="button">
        <html:a href=""
                onmouseover="tit(this, document.title);"
                onmouseout="tit(this, '');"
                onclick="event.preventDefault(); cb(this);">
        <![CDATA[Install this button]]>
        </html:a>
      </html:div>
      <html:a href="https://addons.mozilla.org/addon/custom-buttons/">
        <![CDATA[What's this?]]>
      </html:a>
      <html:div id="credits">
        <html:a href="http://custombuttons.mozdev.org/drupal/node/484">
          <![CDATA[Custom Buttons XML]]><html:br/><![CDATA[Exporter/Importer]]>
        </html:a>
      </html:div>
    </html:div>
  </html:body>

  <name>Bottom Panel</name>
  <image><![CDATA[data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABxUlEQVR4XqWRP2oVURSHvztzXyZg/ENiZ2NjOsUtCHYuQndh4QIs3YCbsLBRwQUIgpViIQQFQdTE5M2bNzPnj+cy7zGFgRT+4OM7d5hzONybbj89enVwrbkngzO0wtBpEF7N9bgOr5SxG5HesF5wWePd0dt0//nP9d3D/ebkBJan0LZwVhwsC2ewCrpgHWdrAQcMaF/2eX83jbf2aE6BdRNcDq5Ctw534dXGhRaGHsyhwvn8IY/58MB5dAfcAcK2MYDPtRmoGmqKidMs4OGTilwDi4o5NefG3RFxzILsNDXkysmYclFKk4iFDdVpSAWohvWCfndH1cIW3g5RrOBGFjF+LwcS6fy1tWBTg3kxGl7UMIqSv/5oefbiGHX+SUrz0Lmciku7Fcetkm9c3+Xxg5uMNk9wKxjmHiZsQVgddwvgyo7x7s1Hcq5gr6mYA5ijmhDV0oSaIhIm8Onb2AcG2efdcWd704EhYrgXl/OMmYNPVME2mG1/sOLtC2ybwrZxYIYDuQ5Nceo6SAZiaA6JYmlaXcxY4NMTVrCTy0sk8uv3v+Tb9z/Sr0ZkEKQfkHEMK1o8FAQVAQdnSl0lPn05keTu/E/+ApLnoYXyGb2zAAAAAElFTkSuQmCC]]></image>
  <mode>0</mode>
  <initcode><![CDATA[/* ***** BEGIN LICENSE BLOCK *****
 * Version: MPL 1.1/GPL 2.0/LGPL 2.1
 *
 * The contents of this file are subject to the Mozilla Public License Version
 * 1.1 (the "License"); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
 * for the specific language governing rights and limitations under the
 * License.
 *
 * The Original Code is Bottom Panel for Custom Buttons.
 *
 * The Initial Developer of the Original Code is LouCypher.
 * Portions created by the Initial Developer are Copyright (C) 2006
 * the Initial Developer. All Rights Reserved.
 *
 * Contributor(s):
 * - LouCypher: original code
 *
 * Alternatively, the contents of this file may be used under the terms of
 * either the GNU General Public License Version 2 or later (the "GPL"),
 * in which case the provisions of the GPL are applicable instead of those
 * above.
 *
 * ***** END LICENSE BLOCK ***** */

// http://web.archive.org/web/20080531160014/http://custombuttons.phpbbnow.com/viewtopic.php?t=160

function $(aId) {
  return document.getElementById(aId);
}

function $xml(aNode, aId, aXML) {
  var node = $(aId);
  if (node) node.parentNode.removeChild(node);
  return aNode.appendChild(cbu.makeXML(aXML))
}

$xml($("appcontent"),
     this.id + "-splitter",
     <splitter xmlns={xulns}
               id={this.id + "-splitter"}
               orient="vertical"
               hidden="true">
       <grippy id={this.id + "-grippy"}
               oncommand={"document.getElementById('" + this.id + "').grippy(event);"} />
     </splitter>);

// For a strange reason, the style doesn't automatically apply
// if it's added as an attribute in grippy element above
$(this.id + "-grippy").style.backgroundImage = "url(chrome://global/skin/splitter/grip-bottom.gif)";

$xml($("appcontent"),
     this.id + "-panel",
     <vbox xmlns={xulns}
           id={this.id + "-panel"}
           height="300"
           hidden="true">
       <toolbox>
         <toolbar align="center">
           <label id={this.id + "-label"} value={this.label} flex="1" crop="end" />
           <toolbarbutton class="tabs-closebutton"
                          oncommand={"document.getElementById('" + this.id + "').closePanel();"} />
         </toolbar>
       </toolbox>
       <browser id={this.id + "-browser"} type="content" src="" flex="1"
                contextmenu="contentAreaContextMenu"
                contentcontextmenu="contentAreaContextMenu"
                tooltip="aHTMLTooltip"
                persist="cachedurl" cachedurl="" clickthrough="never"
                onclick="return window.parent.contentAreaClick(event, true);" />
     </vbox>);

this.togglePanel = function() {
   if (this.panel && ($(this.id + "-browser").getAttribute("src") != content.location.href)) {
    $(this.id + "-browser").setAttribute("src", content.location.href);
    $(this.id + "-browser").setAttribute("cachedurl", content.location.href);
  } else {
    this.panel = !this.panel;
    $(this.id + "-browser").setAttribute("src", this.panel ? content.location.href : "");
    $(this.id + "-browser").setAttribute("cachedurl", this.panel ? content.location.href : "");
    $(this.id + "-panel").hidden = !this.panel;
    $(this.id + "-splitter").hidden = !this.panel;
  }
  $(this.id + "-label").value = content.document.title;
}

this.closePanel = function() {
  this.panel = false;
  $(this.id + "-browser").setAttribute("src", "");
  $(this.id + "-browser").setAttribute("cachedurl", "");
  $(this.id + "-panel").hidden = true;
  $(this.id + "-splitter").hidden = true;
}

this.grippy = function(aEvent) {
  aEvent.target.parentNode.nextSibling.collapsed = !aEvent.target.parentNode.nextSibling.collapsed;
  aEvent.target.style.backgroundImage = (aEvent.target.parentNode.getAttribute("state") == "collapsed")
                                          ? "url(chrome://global/skin/splitter/grip-bottom.gif)"
                                          : "url(chrome://global/skin/splitter/grip-top.gif)";
}

this.panel = false;

]]></initcode>
  <code><![CDATA[this.togglePanel();]]></code>
  <accelkey><![CDATA[]]></accelkey>
  <help><![CDATA[]]></help>
  <attributes/>
</custombutton>
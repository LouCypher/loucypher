<?xml version="1.0" encoding="UTF-8"?>
<custombutton xmlns:cb="http://xsms.nm.ru/custombuttons/"
              xmlns:html="http://www.w3.org/1999/xhtml">
  <html:head>
    <html:title><![CDATA[JS Evaluator]]></html:title>
    <html:link rel="shortcut icon" href=""/>
    <html:style type="text/css"><![CDATA[body { font-size: medium; margin: 0; }
body, code:before, help:before, initcode:before {
  font-family: "Verdana", sans-serif;
}
#wrapper { position: fixed; top: 1em; right: 1em; text-align: center; }
p { font-size: small; text-align: center; }
#button {
  background-color: rgb(85, 168, 2);
  background-image: linear-gradient(to bottom, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -moz-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -o-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -webkit-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  border: 1px solid rgb(58, 116, 4);
  border-radius: .5em;
  -moz-border-radius: .5em;
  -webkit-border-radius: .5em;
  padding: 0;
  margin-bottom: 1em;
  box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -moz-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -o-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -webkit-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
}
#button a {
  color: #000;
  text-shadow: -1pt -1px 0pt rgba(255, 255, 255, .5);
  padding: 1em;
  text-decoration: none;
}
#button a, code, code:before, initcode, initcode:before, help, help:before {
  display: block;
}
#credits { position: fixed; bottom: 1em; right: 1em; font-size: small; }
custombutton { background-color: rgb(171, 171, 171); margin: 1em; }
date, image, mode, accelkey { display: none; }
name { font-weight: bold; font-size: x-large; }
code:before, help:before, initcode:before {
  font-weight: bold;
  font-size: large;
  margin: 0 0 1em;
  padding: .5em;
}
code:before { content: "CODE"; }
help:before { content: "Help"; }
initcode:before { content: "Initialization Code"; }
code, initcode, help {
  background-color: rgb(255, 255, 255);
  border: 1px inset rgb(170, 170, 170);
  font: medium monospace;
  margin: 1em 1em 2em 0;
  padding: 1em;
  text-align: left;
  width: 840px;
  white-space: pre-wrap;
  word-wrap: break-word;
}
.clear { clear: both; }
]]></html:style>
  </html:head>
  <html:body>
    <html:div id="wrapper">
      <html:div id="button">
        <html:a href="custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3EJS%20Evaluator%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bcustombuttons-stdicon-2%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5B/*%20*****%20BEGIN%20LICENSE%20BLOCK%20*****%0A%20*%20Version%3A%20MPL%201.1/GPL%202.0/LGPL%202.1%0A%20*%0A%20*%20The%20contents%20of%20this%20file%20are%20subject%20to%20the%20Mozilla%20Public%20License%20Version%0A%20*%201.1%20%28the%20%22License%22%29%3B%20you%20may%20not%20use%20this%20file%20except%20in%20compliance%20with%0A%20*%20the%20License.%20You%20may%20obtain%20a%20copy%20of%20the%20License%20at%0A%20*%20http%3A//www.mozilla.org/MPL/%0A%20*%0A%20*%20Software%20distributed%20under%20the%20License%20is%20distributed%20on%20an%20%22AS%20IS%22%20basis%2C%0A%20*%20WITHOUT%20WARRANTY%20OF%20ANY%20KIND%2C%20either%20express%20or%20implied.%20See%20the%20License%0A%20*%20for%20the%20specific%20language%20governing%20rights%20and%20limitations%20under%20the%0A%20*%20License.%0A%20*%0A%20*%20The%20Original%20Code%20is%20JS%20Evaluator%20for%20Custom%20Buttons%20extension.%0A%20*%0A%20*%20The%20Initial%20Developer%20of%20the%20Original%20Code%20is%20LouCypher.%0A%20*%20Portions%20created%20by%20the%20Initial%20Developer%20are%20Copyright%20%28C%29%202007%0A%20*%20the%20Initial%20Developer.%20All%20Rights%20Reserved.%0A%20*%0A%20*%20Contributor%28s%29%3A%0A%20*%20%20LouCypher%20%3Cloucypher.moz@gmail.com%3E%0A%20*%0A%20*%20Alternatively%2C%20the%20contents%20of%20this%20file%20may%20be%20used%20under%20the%20terms%20of%0A%20*%20either%20the%20GNU%20General%20Public%20License%20Version%202%20or%20later%20%28the%20%22GPL%22%29%2C%20or%0A%20*%20the%20GNU%20Lesser%20General%20Public%20License%20Version%202.1%20or%20later%20%28the%20%22LGPL%22%29%2C%0A%20*%20in%20which%20case%20the%20provisions%20of%20the%20GPL%20or%20the%20LGPL%20are%20applicable%20instead%0A%20*%20of%20those%20above.%20If%20you%20wish%20to%20allow%20use%20of%20your%20version%20of%20this%20file%20only%0A%20*%20under%20the%20terms%20of%20either%20the%20GPL%20or%20the%20LGPL%2C%20and%20not%20to%20allow%20others%20to%0A%20*%20use%20your%20version%20of%20this%20file%20under%20the%20terms%20of%20the%20MPL%2C%20indicate%20your%0A%20*%20decision%20by%20deleting%20the%20provisions%20above%20and%20replace%20them%20with%20the%20notice%0A%20*%20and%20other%20provisions%20required%20by%20the%20GPL%20or%20the%20LGPL.%20If%20you%20do%20not%20delete%0A%20*%20the%20provisions%20above%2C%20a%20recipient%20may%20use%20your%20version%20of%20this%20file%20under%0A%20*%20the%20terms%20of%20any%20one%20of%20the%20MPL%2C%20the%20GPL%20or%20the%20LGPL.%0A%20*%0A%20*%20*****%20END%20LICENSE%20BLOCK%20*****%20*/%0A%0Avar%20prefString%20%3D%20%22custombuttons.JSEvaluator%22%3B%0A%0Aif%20%28typeof%20copyToClipboard%20%21%3D%20%22function%22%29%20%7B%0A%20%20copyToClipboard%20%3D%20function%20copyToClipboard%28aString%29%20%7B%0A%20%20%20%20Components.classes%5B%22@mozilla.org/widget/clipboardhelper%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Components.interfaces.nsIClipboardHelper%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20.copyString%28aString%29%3B%0A%20%20%7D%0A%7D%0A%0Athis.getPrefs%20%3D%20function%28%29%20%7B%0A%20%20try%20%7B%0A%20%20%20%20return%20gPrefService.getCharPref%28prefString%29%3B%0A%20%20%7D%20catch%28ex%29%20%7B%0A%20%20%20%20return%20%22%22%3B%0A%20%20%7D%0A%7D%0A%0Athis.doCommand%20%3D%20function%28aCommand%29%20%7B%0A%20%20if%20%28aCommand%29%20%7B%0A%20%20%20%20eval%28aCommand%29%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%20%20var%20txt%20%3D%20%22Enter%20JS%20command%5Cn%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%22For%20example%3A%20alert%28%5C%22Hello%2C%20world%21%5C%22%29%22%3B%0A%20%20var%20cmd%20%3D%20prompt%28txt%2C%20this.getPrefs%28%29%2C%20%22JS%20Evaluator%22%29%0A%20%20if%20%28%21cmd%29%20return%3B%0A%20%20gPrefService.setCharPref%28prefString%2C%20cmd%29%3B%0A%20%20try%20%7B%0A%20%20%20%20eval%28cmd%29%3B%0A%20%20%7D%20catch%28ex%29%20%7B%0A%20%20%20%20alert%28ex%29%3B%0A%20%20%7D%0A%7D%0A%0Athis.setAttribute%28%22onclick%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22if%20%28event.button%20%3D%3D%201%29%20%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22this.doCommand%28this.getPrefs%28%29%29%3B%22%29%3B%0A%0A%0Athis.fadeInOut%20%3D%20function%28aNode%2C%20aFade%29%20%7B%0A%20%20window.setTimeout%28function%28%29%20%7B%0A%20%20%20%20switch%20%28aFade%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20aNode.style.opacity%20%3D%20%22.5%22%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20aNode.style.opacity%20%3D%20%221%22%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%20250%29%3B%0A%7D%0A%0A/*this.style.opacity%20%3D%20%22.5%22%3B%0Athis.setAttribute%28%22onmouseover%22%2C%20%22this.fadeInOut%28this%2C%201%29%22%29%3B%0Athis.setAttribute%28%22onmouseout%22%2C%20%22this.fadeInOut%28this%2C%200%29%22%29%3B*/%0A%0Athis.setAttribute%28%22accesskey%22%2C%20%22J%22%29%3B%0A%0A%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5Bthis.doCommand%28%29%0A%0A%5D%5D%3E%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E" rel="nofollow" title="Install JS Evaluator">
        <![CDATA[Install this button]]>
        </html:a>
      </html:div>
      <html:a href="https://addons.mozilla.org/addon/custom-buttons/?src=custom-buttons-xml">
        <![CDATA[What's this?]]>
      </html:a>
      <html:div id="credits">
        <html:a href="http://custombuttons.sourceforge.net/forum/viewtopic.php?t=78#p197">
          <![CDATA[Custom Buttons XML]]><html:br/><![CDATA[Exporter/Importer]]>
        </html:a>
      </html:div>
    </html:div>
  </html:body>
  <date id="date" value="20120329"/>
  <name>JS Evaluator</name>
  <image><![CDATA[custombuttons-stdicon-2]]></image>
  <mode>0</mode>
  <initcode><![CDATA[/* ***** BEGIN LICENSE BLOCK *****
 * Version: MPL 1.1/GPL 2.0/LGPL 2.1
 *
 * The contents of this file are subject to the Mozilla Public License Version
 * 1.1 (the "License"); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
 * for the specific language governing rights and limitations under the
 * License.
 *
 * The Original Code is JS Evaluator for Custom Buttons extension.
 *
 * The Initial Developer of the Original Code is LouCypher.
 * Portions created by the Initial Developer are Copyright (C) 2007
 * the Initial Developer. All Rights Reserved.
 *
 * Contributor(s):
 *  LouCypher <loucypher.moz@gmail.com>
 *
 * Alternatively, the contents of this file may be used under the terms of
 * either the GNU General Public License Version 2 or later (the "GPL"), or
 * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
 * in which case the provisions of the GPL or the LGPL are applicable instead
 * of those above. If you wish to allow use of your version of this file only
 * under the terms of either the GPL or the LGPL, and not to allow others to
 * use your version of this file under the terms of the MPL, indicate your
 * decision by deleting the provisions above and replace them with the notice
 * and other provisions required by the GPL or the LGPL. If you do not delete
 * the provisions above, a recipient may use your version of this file under
 * the terms of any one of the MPL, the GPL or the LGPL.
 *
 * ***** END LICENSE BLOCK ***** */

var prefString = "custombuttons.JSEvaluator";

if (typeof copyToClipboard != "function") {
  copyToClipboard = function copyToClipboard(aString) {
    Components.classes["@mozilla.org/widget/clipboardhelper;1"]
              .getService(Components.interfaces.nsIClipboardHelper)
              .copyString(aString);
  }
}

this.getPrefs = function() {
  try {
    return gPrefService.getCharPref(prefString);
  } catch(ex) {
    return "";
  }
}

this.doCommand = function(aCommand) {
  if (aCommand) {
    eval(aCommand);
    return;
  }
  var txt = "Enter JS command\n" +
            "For example: alert(\"Hello, world!\")";
  var cmd = prompt(txt, this.getPrefs(), "JS Evaluator")
  if (!cmd) return;
  gPrefService.setCharPref(prefString, cmd);
  try {
    eval(cmd);
  } catch(ex) {
    alert(ex);
  }
}

this.setAttribute("onclick",
                  "if (event.button == 1) " +
                  "this.doCommand(this.getPrefs());");


this.fadeInOut = function(aNode, aFade) {
  window.setTimeout(function() {
    switch (aFade) {
      case 0:
        aNode.style.opacity = ".5";
        break;
      case 1:
        aNode.style.opacity = "1";
    }
  }, 250);
}

/*this.style.opacity = ".5";
this.setAttribute("onmouseover", "this.fadeInOut(this, 1)");
this.setAttribute("onmouseout", "this.fadeInOut(this, 0)");*/

this.setAttribute("accesskey", "J");

]]></initcode>
  <code><![CDATA[this.doCommand()

]]></code>
  <accelkey><![CDATA[]]></accelkey>
  <help><![CDATA[]]></help>
  <attributes/>
</custombutton>
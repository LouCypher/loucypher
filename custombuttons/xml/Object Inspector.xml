<?xml version="1.0" encoding="UTF-8"?>
<custombutton xmlns:cb="http://xsms.nm.ru/custombuttons/"
              xmlns:html="http://www.w3.org/1999/xhtml">
  <html:head>
    <html:title><![CDATA[Object Inspector]]></html:title>
    <html:link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sFGw4IIuzy/0QAAAC+SURBVDjLzZItDgJBDEYfPwr0rGU1waJB47kE4Q6chTvgVxP0YneRu2iwYDpJ6ZYJBMOXNJl0Oi+dr4UfNXByCyAHLiY/lbhLdDQBGuAhYVWou1VM9lXBGsjkXDqAEmjlvPEAY1U4cwBbYG9qXwBR14RnN5vQgPivOgGolaHBM6gB5glAACpttP1CZslGIwlXB6EWCcBOdRpsB6cvFvAczfamkCcedu6GzohyabPnbOLy3Tijw8cPVrmSMf6JngTgKsyos8rlAAAAAElFTkSuQmCC"/>
    <html:style type="text/css"><![CDATA[body { font-size: medium; margin: 0; }
body, code:before, help:before, initcode:before {
  font-family: "Verdana", sans-serif;
}
#wrapper { position: fixed; top: 1em; right: 1em; text-align: center; }
p { font-size: small; text-align: center; }
#button {
  background-color: rgb(85, 168, 2);
  background-image: linear-gradient(to bottom, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -moz-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -o-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  background-image: -webkit-linear-gradient(top, rgb(147, 200, 94), rgb(85, 168, 2));
  border: 1px solid rgb(58, 116, 4);
  border-radius: .5em;
  -moz-border-radius: .5em;
  -webkit-border-radius: .5em;
  padding: 0;
  margin-bottom: 1em;
  box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -moz-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -o-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
  -webkit-box-shadow: 1px 2px 3px rgba(0, 0, 0, .25);
}
#button a {
  color: #000;
  text-shadow: -1pt -1px 0pt rgba(255, 255, 255, .5);
  padding: 1em;
  text-decoration: none;
}
#button a, code, code:before, initcode, initcode:before, help, help:before {
  display: block;
}
#credits { position: fixed; bottom: 1em; right: 1em; font-size: small; }
custombutton { background-color: rgb(171, 171, 171); margin: 1em; }
date, image, mode, accelkey { display: none; }
name { font-weight: bold; font-size: x-large; }
code:before, help:before, initcode:before {
  font-weight: bold;
  font-size: large;
  margin: 0 0 1em;
  padding: .5em;
}
code:before { content: "CODE"; }
help:before { content: "Help"; }
initcode:before { content: "Initialization Code"; }
code, initcode, help {
  background-color: rgb(255, 255, 255);
  border: 1px inset rgb(170, 170, 170);
  font: medium monospace;
  margin: 1em 1em 2em 0;
  padding: 1em;
  text-align: left;
  width: 840px;
  white-space: pre-wrap;
  word-wrap: break-word;
}
.clear { clear: both; }
]]></html:style>
  </html:head>
  <html:body>
    <html:div id="wrapper">
      <html:div id="button">
        <html:a href="custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3EObject%20Inspector%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sFGw4IIuzy/0QAAAC+SURBVDjLzZItDgJBDEYfPwr0rGU1waJB47kE4Q6chTvgVxP0YneRu2iwYDpJ6ZYJBMOXNJl0Oi+dr4UfNXByCyAHLiY/lbhLdDQBGuAhYVWou1VM9lXBGsjkXDqAEmjlvPEAY1U4cwBbYG9qXwBR14RnN5vQgPivOgGolaHBM6gB5glAACpttP1CZslGIwlXB6EWCcBOdRpsB6cvFvAczfamkCcedu6GzohyabPnbOLy3Tijw8cPVrmSMf6JngTgKsyos8rlAAAAAElFTkSuQmCC%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5Bif%28typeof%20inspectObject%20%21%3D%20%22function%22%29%20%7B%0A%20%20var%20ext%20%3D%20%22DOM%20Inspector%22%3B%0A%20%20var%20err%20%3D%20ext%20+%20%22%20extension%20is%20not%20installed%20or%20is%20disabled.%22%3B%0A%20%20this.setAttribute%28%22oncommand%22%2C%20%22alert%28%27%22%20+%20err%20+%20%22%27%29%3B%22%29%3B%0A%20%20return%3B%0A%7D%0A%0Avar%20Cc%20%3D%20Components.classes%2C%20Ci%20%3D%20Components.interfaces%3B%0A%0Avar%20prefService%20%3D%20Cc%5B%22@mozilla.org/preferences-service%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIPrefBranch2%29%3B%0A%0Afunction%20getPref%28%29%20%7B%0A%20%20try%20%7B%0A%20%20%20%20return%20prefService.getCharPref%28%22custombuttons.inspectObject%22%29%3B%0A%20%20%7D%20catch%28ex%29%20%7B%0A%20%20%20%20return%20%22%22%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20selectItems%28aText%2C%20aItems%2C%20aTitle%29%20%7B%0A%20%20var%20promptService%20%3D%20Cc%5B%22@mozilla.org/embedcomp/prompt-service%3B1%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.getService%28Ci.nsIPromptService%29%3B%0A%0A%20%20var%20selected%20%3D%20%7B%7D%3B%0A%20%20var%20result%20%3D%20promptService.select%28null%2C%20aTitle%2C%20aText%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aItems.length%2C%20aItems%2C%20selected%29%3B%0A%20%20if%20%28result%29%20return%20aItems%5Bselected.value%5D%3B%0A%20%20return%3B%0A%7D%0A%0Athis.inspectObject%20%3D%20function%28aPrompt%29%20%7B%0A%20%20if%20%28aPrompt%29%20%7B%0A%20%20%20%20var%20text%20%3D%20%22Enter%20object%20name%20%28case%20sensitive%29%5Cn%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22For%20example%3A%20document%2C%20gBrowser%2C%20custombuttons%22%3B%0A%20%20%20%20var%20objStr%20%3D%20prompt%28text%2C%20getPref%28%29%2C%20%22Object%20Inspector%22%29%3B%0A%20%20%20%20if%20%28%21objStr%29%20return%3B%0A%20%20%20%20prefService.setCharPref%28%22custombuttons.inspectObject%22%2C%20objStr%29%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20inspectObject%28eval%28objStr%29%29%3B%0A%20%20%20%20%7D%20catch%28ex%29%20%7B%0A%20%20%20%20%20%20//alert%28objStr%20+%20%22%20is%20not%20an%20object.%22%29%3B%0A%20%20%20%20%20%20alert%28ex%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20var%20objArray%20%3D%20%5B%5D%3B%0A%20%20for%20%28var%20i%20in%20window%29%20%7B%0A%20%20%20%20if%20%28typeof%20eval%28i%29%20%3D%3D%20%22object%22%29%20objArray.push%28i%29%3B%0A%20%20%7D%0A%20%20if%20%28%21objArray.length%29%20return%3B%0A%20%20objArray.sort%28function%28a%2Cb%29%20%7B%0A%20%20%20%20a%20%3D%20a.toLowerCase%28%29%3B%0A%20%20%20%20b%20%3D%20b.toLowerCase%28%29%3B%0A%20%20%20%20if%20%28a%20%3C%20b%29%20return%20-1%3B%0A%20%20%20%20if%20%28a%20%3E%20b%29%20return%201%3B%0A%20%20%20%20return%200%3B%0A%20%20%7D%29%0A%0A%20%20var%20obj%20%3D%20selectItems%28objArray.length%20+%20%22%20objects%20found%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20objArray%2C%20%22Object%20Inspector%22%29%3B%0A%20%20if%20%28obj%29%20eval%28%22inspectObject%28%22%20+%20obj%20+%20%22%29%22%29%3B%0A%7D%0A%0Athis.setAttribute%28%22onclick%22%2C%20%22if%20%28event.button%20%3D%3D%201%29%20%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22this.inspectObject%28true%29%3B%22%29%3B%0A%0Athis.setAttribute%28%22homepage%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A//custombuttons.phpbbnow.com/%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22viewtopic.php%3Fp%3D3177%233177%22%29%3B%0A%0A%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5B//%20Last%20updated%3A%202007-04-27%0A%0A%0Athis.inspectObject%28true%29%3B%0A%0A%5D%5D%3E%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E" rel="nofollow" title="Install Object Inspector">
        <![CDATA[Install this button]]>
        </html:a>
      </html:div>
      <html:a href="https://addons.mozilla.org/addon/custom-buttons/?src=custom-buttons-xml">
        <![CDATA[What's this?]]>
      </html:a>
      <html:div id="credits">
        <html:a href="http://custombuttons.sourceforge.net/forum/viewtopic.php?t=78#p197">
          <![CDATA[Custom Buttons XML]]><html:br/><![CDATA[Exporter/Importer]]>
        </html:a>
      </html:div>
    </html:div>
  </html:body>
  <date id="date" value="20120329"/>
  <name>Object Inspector</name>
  <image><![CDATA[data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sFGw4IIuzy/0QAAAC+SURBVDjLzZItDgJBDEYfPwr0rGU1waJB47kE4Q6chTvgVxP0YneRu2iwYDpJ6ZYJBMOXNJl0Oi+dr4UfNXByCyAHLiY/lbhLdDQBGuAhYVWou1VM9lXBGsjkXDqAEmjlvPEAY1U4cwBbYG9qXwBR14RnN5vQgPivOgGolaHBM6gB5glAACpttP1CZslGIwlXB6EWCcBOdRpsB6cvFvAczfamkCcedu6GzohyabPnbOLy3Tijw8cPVrmSMf6JngTgKsyos8rlAAAAAElFTkSuQmCC]]></image>
  <mode>0</mode>
  <initcode><![CDATA[if(typeof inspectObject != "function") {
  var ext = "DOM Inspector";
  var err = ext + " extension is not installed or is disabled.";
  this.setAttribute("oncommand", "alert('" + err + "');");
  return;
}

var Cc = Components.classes, Ci = Components.interfaces;

var prefService = Cc["@mozilla.org/preferences-service;1"]
                    .getService(Ci.nsIPrefBranch2);

function getPref() {
  try {
    return prefService.getCharPref("custombuttons.inspectObject");
  } catch(ex) {
    return "";
  }
}

function selectItems(aText, aItems, aTitle) {
  var promptService = Cc["@mozilla.org/embedcomp/prompt-service;1"]
                        .getService(Ci.nsIPromptService);

  var selected = {};
  var result = promptService.select(null, aTitle, aText,
                              aItems.length, aItems, selected);
  if (result) return aItems[selected.value];
  return;
}

this.inspectObject = function(aPrompt) {
  if (aPrompt) {
    var text = "Enter object name (case sensitive)\n" +
               "For example: document, gBrowser, custombuttons";
    var objStr = prompt(text, getPref(), "Object Inspector");
    if (!objStr) return;
    prefService.setCharPref("custombuttons.inspectObject", objStr)
    try {
      inspectObject(eval(objStr));
    } catch(ex) {
      //alert(objStr + " is not an object.");
      alert(ex);
    }
    return;
  }

  var objArray = [];
  for (var i in window) {
    if (typeof eval(i) == "object") objArray.push(i);
  }
  if (!objArray.length) return;
  objArray.sort(function(a,b) {
    a = a.toLowerCase();
    b = b.toLowerCase();
    if (a < b) return -1;
    if (a > b) return 1;
    return 0;
  })

  var obj = selectItems(objArray.length + " objects found",
                        objArray, "Object Inspector");
  if (obj) eval("inspectObject(" + obj + ")");
}

this.setAttribute("onclick", "if (event.button == 1) " +
                             "this.inspectObject(true);");

this.setAttribute("homepage",
                   "http://custombuttons.phpbbnow.com/" +
                   "viewtopic.php?p=3177#3177");

]]></initcode>
  <code><![CDATA[// Last updated: 2007-04-27


this.inspectObject(true);

]]></code>
  <accelkey><![CDATA[]]></accelkey>
  <help><![CDATA[]]></help>
  <attributes/>
</custombutton>